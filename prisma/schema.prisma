generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model accounts {
  id             String           @id @default(uuid())
  username       String?
  passHash       String?
  menu           Json?
  role           String           @default("user")
  active         Boolean          @default(true)
  createdById    String?
  updatedById    String?
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  drugPurchases  drugpurchases[]
  drugsInventory drugsinventory[]
  encounters     encounters[]
  patients       patients[]
  payments       payment[]
  reciepts       reciept[]
  stocksHistory  stockshistory[]
  transactions   transaction[]
}

model patients {
  id           String        @id @default(cuid())
  hosp_no      String
  no           Int?
  year         Int?
  month        String?
  name         String?
  sex          String?
  age          String?
  occupation   String?
  religion     String?
  phone_no     String?
  reg_date     DateTime?
  createdById  String?
  updatedById  String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  group_id     String?
  townId       String?
  encounters   encounters[]
  groups       groups?       @relation(fields: [group_id], references: [id])
  town         town?         @relation(fields: [townId], references: [id])
  updatedBy    accounts?     @relation(fields: [updatedById], references: [id])
  transactions transaction[]
}

model encounters {
  id               String             @id @default(uuid())
  patient_id       String?
  year             Int?
  month            String?
  enc_date         DateTime?          @default(now())
  time             String?
  admitted         Boolean            @default(false)
  outcome          String?
  care_id          String?
  createdById      String?
  updatedById      String?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  admission        admission?
  anc              anc[]
  delivery         delivery[]
  drugsGiven       drugsgiven[]
  care             care?              @relation(fields: [care_id], references: [id])
  patient          patients?          @relation(fields: [patient_id], references: [id])
  updatedBy        accounts?          @relation(fields: [updatedById], references: [id])
  follow_ups       followups[]
  immunization     immunization[]
  labTest          labtest[]
  operations       operations[]
  prescriptionHist prescriptionhist[]
  diagnosis        diagnosis[]
}

model followups {
  id           String      @id @default(cuid())
  encounter_id String?
  year         Int?
  month        String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  encounter    encounters? @relation(fields: [encounter_id], references: [id])
}

model immunization {
  id           String      @id @default(cuid())
  encounter_id String?
  type         String?
  date         DateTime?
  next_date    DateTime?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  encounter    encounters? @relation(fields: [encounter_id], references: [id])
}

model admission {
  id            String      @id @default(cuid())
  encounter_id  String?     @unique
  adm_date      DateTime?
  admitted_for  Int?
  discharged_on DateTime?
  nok_phone     String?
  ward_matron   String?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  encounter     encounters? @relation(fields: [encounter_id], references: [id])
}

model anc {
  id             String      @id @default(cuid())
  encounter_id   String?
  ega            String?
  fe_no          String?
  fe_liq_vol     String?
  fe_abnormality String?
  fe_diagnosis   String?
  fe_live        String?
  placenta_pos   String?
  date           DateTime    @default(now())
  edd            DateTime?
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  encounter      encounters? @relation(fields: [encounter_id], references: [id])
}

model delivery {
  id                String      @id @default(uuid())
  encounter_id      String?
  parity            String?
  mother_diag       String?
  mother_outcome    String?
  labour_duration   String?
  delivery_date     DateTime?   @default(now())
  delivery_type     String?
  placenta_delivery String?
  apgar_score       String?
  baby_maturity     String?
  baby_weight       String?
  baby_sex          String?
  baby_outcome      String?
  congenital_no     Int?
  midwife           String?
  year              Int?
  month             String?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  encounter         encounters? @relation(fields: [encounter_id], references: [id])
}

model drugsgiven {
  id               String             @id @default(cuid())
  rate             Int?               @default(0)
  price            Int?               @default(0)
  quantity         Int?               @default(0)
  drug_id          String?
  name             String?
  encounter_id     String?
  year             Int?
  month            String?
  package          String?
  date             DateTime           @default(now())
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  drug             drugsinventory?    @relation(fields: [drug_id], references: [id])
  encounter        encounters?        @relation(fields: [encounter_id], references: [id])
  prescriptionHist prescriptionhist[]
}

model operations {
  id           String      @id @default(cuid())
  encounter_id String?
  procedureId  String?
  proc_date    DateTime    @default(now())
  surgeon      String?
  assistant    String?
  outcome      String?
  anaesthesia  String?
  year         Int?
  month        String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  encounter    encounters? @relation(fields: [encounter_id], references: [id])
  procedure    procedures? @relation(fields: [procedureId], references: [id])
}

model labtest {
  id           String      @id @default(cuid())
  encounter_id String?
  test_id      String
  result       String?
  rate         Int?
  info         String?
  date         DateTime    @default(now())
  year         Int?
  month        String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  unit         String?
  encounter    encounters? @relation(fields: [encounter_id], references: [id])
  testType     tests       @relation(fields: [test_id], references: [id])
}

model transaction {
  id          String    @id
  total       Int
  balance     Int
  year        Int
  month       String
  status      String
  createdById String?
  updatedById String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  patientId   String?
  payments    payment[]
  reciepts    reciept[]
  items       tnxitem[]
  patient     patients? @relation(fields: [patientId], references: [id])
  updatedBy   accounts? @relation(fields: [updatedById], references: [id])
}

model tnxitem {
  id            String      @id @default(uuid())
  transactionId String
  feeId         String
  price         Int
  paid          Int
  balance       Int
  active        Boolean     @default(true)
  year          Int?
  month         String?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  payments      payment[]
  fee           fees        @relation(fields: [feeId], references: [id])
  transaction   transaction @relation(fields: [transactionId], references: [id])
}

model payment {
  id          String       @id @default(uuid())
  tnxId       String?
  itemId      String
  name        String
  paid        Int
  method      String?
  createdById String?
  type        String       @default("payment")
  year        Int?
  month       String?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  createdBy   accounts?    @relation(fields: [createdById], references: [id])
  tnxItem     tnxitem      @relation(fields: [itemId], references: [id])
  transaction transaction? @relation(fields: [tnxId], references: [id])
}

model reciept {
  id          String      @id
  items       Json
  tnxId       String
  year        Int
  month       String
  status      String
  createdById String?
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  createdBy   accounts?   @relation(fields: [createdById], references: [id])
  transaction transaction @relation(fields: [tnxId], references: [id])
}

model drugsummary {
  id            String   @id @default(uuid())
  name          String?
  totalSGain    Int?
  totalSLoss    Int?
  stockStart    Int?
  prescriptions Int?
  encounters    Int?
  year          Int?
  month         String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

// model dispensersummary {
//   id            String    @id @default(uuid())
//   name          String?
//   avlStock      Int?
//   input         Int?
//   loss          Int?
//   prescriptions Int?
//   avlBal        Int?
//   dispenserId   String?
//   dispenserName accounts? @relation(fields: [dispenserId], references: [id])
//   year          Int?
//   month         String?
//   createdAt     DateTime  @default(now())
//   updatedAt     DateTime  @updatedAt
// }

model drugsinventory {
  id            String          @id @default(uuid())
  stock_qty     Int             @default(0)
  added         Int?            @default(0)
  rate          Int?            @default(0)
  createdById   String?
  updatedById   String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  drugId        String          @unique
  drugPurchases drugpurchases[]
  givenHistory  drugsgiven[]
  drug          drugs           @relation(fields: [drugId], references: [id])
  updatedBy     accounts?       @relation(fields: [updatedById], references: [id])
  stockHistory  stockshistory[]
}

model prescriptionhist {
  id           Int         @id @default(autoincrement())
  drug         String
  hosp_no      String
  quantity     Int
  rate         Int?        @default(0)
  price        Int?        @default(0)
  stock_remain Int?
  month        String?
  date         DateTime    @default(now())
  time         String?
  year         Int?
  given_id     String?
  enc_id       String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  encounter    encounters? @relation(fields: [enc_id], references: [id])
  given        drugsgiven? @relation(fields: [given_id], references: [id])
}

model stockshistory {
  id          Int             @id @default(autoincrement())
  drug_id     String?
  name        String?
  type        String?
  stock_qty   Int?
  added       Int?
  month       String?
  year        Int?
  updatedById String?
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  drug        drugsinventory? @relation(fields: [drug_id], references: [id])
  updatedBy   accounts?       @relation(fields: [updatedById], references: [id])
}

model drugpurchases {
  id          String          @id @default(uuid())
  drug_id     String?
  name        String?
  quantity    Int?
  price       Int?
  month       String?
  time        String?
  year        Int?
  date        DateTime        @default(now())
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  createdById String?
  createdBy   accounts?       @relation(fields: [createdById], references: [id])
  drug        drugsinventory? @relation(fields: [drug_id], references: [id])
}

model drugs {
  id        String          @id @default(cuid())
  name      String?
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt
  inventory drugsinventory?
}

model diagnosis {
  id         String       @id @default(cuid())
  name       String?
  createdAt  DateTime     @default(now())
  encounters encounters[]
}

model town {
  id        String     @id @default(cuid())
  name      String?
  createdAt DateTime   @default(now())
  patienst  patients[]
}

model tests {
  id        String    @id @default(cuid())
  name      String?
  createdAt DateTime  @default(now())
  labTests  labtest[]
}

model procedures {
  id         String       @id @default(cuid())
  name       String?
  createdAt  DateTime     @default(now())
  operations operations[]
}

model fees {
  id        String    @id @default(cuid())
  name      String?
  amount    Int?
  createdAt DateTime  @default(now())
  tnxItems  tnxitem[]
}

model care {
  id         String       @id @default(cuid())
  name       String
  createdAt  DateTime     @default(now())
  encounters encounters[]
}

model groups {
  id        String     @id @default(cuid())
  name      String
  createdAt DateTime   @default(now())
  patients  patients[]
}
